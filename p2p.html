
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SADC CBDC Platform</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f6f8;
      margin: 0;
      padding: 0;
    }
    .container {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      margin-top: 50px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    input, select, button {
      width: 100%;
      margin: 10px 0;
      padding: 10px;
    }
    button {
      background: #0066cc;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background: #004c99;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>SADC CBDC Portal</h1>

  <div id="auth">
    <select id="countryCode">
      <option value="+27">+27 (South Africa)</option>
      <option value="+263">+263 (Zimbabwe)</option>
      <option value="+260">+260 (Zambia)</option>
    </select>

    <select id="nationality">
      <option value="South Africa">South Africa</option>
      <option value="Zimbabwe">Zimbabwe</option>
      <option value="Zambia">Zambia</option>
      <!-- Add more -->
    </select>

    <input type="text" id="name" placeholder="Full Name" />
    <input type="email" id="email" placeholder="Email" />
    <input type="text" id="house" placeholder="Office Address" />
    <input type="text" id="phone" placeholder="Phone Number" />
    <input type="text" id="bankName" placeholder="Bank Name" />
    <input type="text" id="bankAcc" placeholder="Bank Account Number" />
    <input type="password" id="pin" placeholder="4-digit PIN" />

    <button onclick="register()">Register</button>
    <button onclick="login()">Login</button>
  </div>

  <div id="dashboard" style="display:none;">
    <h2>Welcome, <span id="userPhone"></span></h2>
    <p>CBDC Balance: <span id="cbdcBalance">0</span></p>
    <p>Bank Balance: <span id="bankBalance">0</span></p>
    <p>Bank: <span id="bankNameDisplay"></span></p>
    <p>Account #: <span id="accountNoDisplay"></span></p>

    <input type="number" id="transferAmount" placeholder="Amount to transfer" />
    <button onclick="transferToBank()">Transfer CBDC to Bank</button>
  </div>
</div>

<script>
  let userPhone = "";

  function register() {
    const data = {
      name: document.getElementById('name').value,
      email: document.getElementById('email').value,
      office: document.getElementById('house').value,
      nationality: document.getElementById('nationality').value,
      phone: document.getElementById('countryCode').value + document.getElementById('phone').value.trim(),
      bankName: document.getElementById('bankName').value,
      bankAcc: document.getElementById('bankAcc').value,
      pin: document.getElementById('pin').value
    };

    fetch('http://localhost:3000/api/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    }).then(res => res.json()).then(resp => {
      alert(resp.success ? "Registration successful!" : "Registration failed.");
    });
  }

  function login() {
    const phone = document.getElementById('countryCode').value + document.getElementById('phone').value.trim();
    const pin = document.getElementById('pin').value;
    fetch('http://localhost:3000/api/validate-pin', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ phone, pin })
    }).then(res => res.json()).then(data => {
      if (data.valid) {
        userPhone = phone;
        loadDashboard();
      } else {
        alert("Invalid login");
      }
    });
  }

  function loadDashboard() {
    fetch(`http://localhost:3000/api/get-balance?phone=${userPhone}`)
      .then(res => res.json())
      .then(data => {
        document.getElementById('auth').style.display = 'none';
        document.getElementById('dashboard').style.display = 'block';
        document.getElementById('userPhone').textContent = userPhone;
        document.getElementById('cbdcBalance').textContent = data.cbdc_balance;
        document.getElementById('bankBalance').textContent = data.bank_balance;
        document.getElementById('bankNameDisplay').textContent = data.bank_name;
        document.getElementById('accountNoDisplay').textContent = data.bank_account_no;
      });
  }

  function transferToBank() {
    const amount = document.getElementById('transferAmount').value;
    fetch('http://localhost:3000/api/transfer', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ phone: userPhone, amount })
    }).then(res => res.json()).then(data => {
      if (data.success) {
        alert("Transfer successful!");
        loadDashboard();
      } else {
        alert("Transfer failed: " + (data.error || "Unknown error"));
      }
    });
  }
</script>
</body>
</html>



